---
title: Referência-Azure Policy linha de base de configuração de convidado para Linux
description: Detalhes da linha de base do Linux no Azure implementadas por meio da configuração de convidado do Azure Policy.
ms.date: 03/12/2021
ms.topic: reference
ms.custom: generated
ms.openlocfilehash: 6b1d3048fdc0945e1ee64e211d2f7b1f9de5e6e6
ms.sourcegitcommit: df1930c9fa3d8f6592f812c42ec611043e817b3b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/13/2021
ms.locfileid: "103419857"
---
# <a name="azure-policy-guest-configuration-baseline-for-linux"></a>Linha de base de configuração de convidado Azure Policy para Linux

O artigo a seguir detalha quais **\[ \] computadores Linux de visualização devem atender aos requisitos para as** auditorias de definição de política de configuração de convidado de linha de base de segurança do Azure. Para obter mais informações, consulte [Azure Policy configuração de convidado](../concepts/guest-configuration.md) e [visão geral do benchmark de segurança do Azure (v2)](../../../security/benchmarks/overview.md).

## <a name="general-security-controls"></a>Controles de segurança gerais

|Nome<br /><sub>SESSÃO</sub> |Detalhes |Verificação de correção |
|---|---|---|
|Verifique se a opção nodev está definida na partição/home.<br /><sub>1.1.4</sub> |Descrição: um invasor pode montar um dispositivo especial (por exemplo, dispositivo de bloco ou de caractere) na partição/home. |Edite o arquivo/etc/fstab e nodev o quarto campo (opções de montagem) para a partição/home. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção nodev está definida na partição/tmp.<br /><sub>1.1.5</sub> |Descrição: um invasor pode montar um dispositivo especial (por exemplo, dispositivo de bloco ou de caractere) na partição/tmp. |Edite o arquivo/etc/fstab e nodev o quarto campo (opções de montagem) para a partição/tmp. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção nodev está definida na partição/var/tmp.<br /><sub>1.1.6</sub> |Descrição: um invasor pode montar um dispositivo especial (por exemplo, dispositivo de bloco ou de caractere) na partição/var/tmp. |Edite o arquivo/etc/fstab e nodev o quarto campo (opções de montagem) para a partição/var/tmp. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção nosuid está definida na partição/tmp.<br /><sub>1.1.7</sub> |Descrição: como o sistema de arquivos/tmp destina-se apenas ao armazenamento temporário de arquivos, defina essa opção para garantir que os usuários não possam criar arquivos setuid no/var/tmp. |Edite o arquivo/etc/fstab e nosuid o quarto campo (opções de montagem) para a partição/tmp. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção nosuid está definida na partição/var/tmp.<br /><sub>(1.1.8)</sub> |Descrição: como o sistema de arquivos/var/tmp destina-se apenas ao armazenamento temporário de arquivos, defina essa opção para garantir que os usuários não possam criar arquivos setuid no/var/tmp. |Edite o arquivo/etc/fstab e nosuid o quarto campo (opções de montagem) para a partição/var/tmp. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção noexec está definida na partição/var/tmp.<br /><sub>1.1.9</sub> |Descrição: como o `/var/tmp` sistema de arquivos destina-se apenas ao armazenamento temporário de arquivos, defina essa opção para garantir que os usuários não possam executar binários executáveis do `/var/tmp` . |Edite o arquivo/etc/fstab e adicione noexec ao quarto campo (opções de montagem) para a partição/var/tmp. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Verifique se a opção noexec está definida na partição/dev/shm.<br /><sub>(1.1.16)</sub> |Descrição: definir essa opção em um sistema de arquivos impede que os usuários executem programas da memória compartilhada. Isso impedirá que os usuários introduzam software potencialmente mal-intencionado no sistema. |Edite o arquivo/etc/fstab e adicione noexec ao quarto campo (opções de montagem) para a partição/dev/shm. Para obter mais informações, consulte as páginas manuais do fstab (5). |
|Desabilitar a montagem automática<br /><sub>(1.1.21)</sub> |Descrição: com a montagem automática habilitada, qualquer pessoa com acesso físico pode anexar uma unidade USB ou um disco e ter seu conteúdo disponível no sistema mesmo que ele não tenha permissões para montá-lo por conta própria. |Desabilite o serviço autofs ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-autofs ' |
|Verifique se a montagem de dispositivos de armazenamento USB está desabilitada<br /><sub>(1.1.21.1)</sub> |Descrição: a remoção do suporte para dispositivos de armazenamento USB reduz a superfície de ataque local do servidor. |Edite ou crie um arquivo no `/etc/modprobe.d/` diretório que termina em. conf e adicione `install usb-storage /bin/true` , em seguida, descarregue o módulo de armazenamento USB ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unding-kernel-mods ' |
|Certifique-se de que os dumps principais sejam restritos.<br /><sub>1.5.1</sub> |Descrição: definir um limite rígido em dumps de núcleo impede que os usuários substituam a variável flexível. Se os dumps principais forem necessários, considere a definição de limites para grupos de usuários (consulte `limits.conf(5)` ). Além disso, a definição da `fs.suid_dumpable` variável como 0 impedirá que os programas setuid dedumpm o núcleo. |Adicione `hard core 0` ao/etc/security/limits.conf. ou a um arquivo no diretório Limits. d e defina `fs.suid_dumpable = 0` em sysctl ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Core-dumps ' |
|Verifique se o Prelink está desabilitado.<br /><sub>(1.5.4)</sub> |Descrição: o recurso de previnculação pode interferir na operação de auxílio, pois ele altera os binários. A previnculação também pode aumentar a vulnerabilidade do sistema se um usuário mal-intencionado for capaz de comprometer uma biblioteca comum, como o LIBC. |Desinstale `prelink` usando o Gerenciador de pacotes ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r remove-Prelink ' |
|Verifique se as permissões em/etc/motd estão configuradas.<br /><sub>(1.7.1.4)</sub> |Descrição: se o `/etc/motd` arquivo não tiver a propriedade correta, ele poderá ser modificado por usuários não autorizados com informações incorretas ou enganosas. |Defina o proprietário e o grupo de/etc/motd como root e defina permissões como 0644 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verifique se as permissões em/etc/issue estão configuradas.<br /><sub>(1.7.1.5)</sub> |Descrição: se o `/etc/issue` arquivo não tiver a propriedade correta, ele poderá ser modificado por usuários não autorizados com informações incorretas ou enganosas. |Defina o proprietário e o grupo de/etc/issue como root e defina permissões como 0644 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verifique se as permissões em/etc/issue.net estão configuradas.<br /><sub>(1.7.1.6)</sub> |Descrição: se o `/etc/issue.net` arquivo não tiver a propriedade correta, ele poderá ser modificado por usuários não autorizados com informações incorretas ou enganosas. |Defina o proprietário e o grupo de/etc/issue.net como root e defina permissões como 0644 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|A opção nodev deve ser habilitada para todas as mídias removíveis.<br /><sub>(2,1)</sub> |Descrição: um invasor pode montar um dispositivo especial (por exemplo, dispositivo de bloco ou de caractere) via mídia removível |Adicione a opção nodev ao quarto campo (opções de montagem) no/etc/fstab |
|A opção noexec deve ser habilitada para todas as mídias removíveis.<br /><sub>(2,2)</sub> |Descrição: um invasor pode carregar o arquivo executável via mídia removível |Adicione a opção noexec ao quarto campo (opções de montagem) no/etc/fstab |
|A opção nosuid deve ser habilitada para todas as mídias removíveis.<br /><sub>(2,3)</sub> |Descrição: um invasor pode carregar arquivos executados com um contexto de segurança elevado por meio de mídia removível |Adicione a opção nosuid ao quarto campo (opções de montagem) no/etc/fstab |
|Certifique-se de que o cliente de comunicação não esteja instalado.<br /><sub>2.3.3</sub> |Descrição: o software apresenta um risco de segurança, pois usa protocolos não criptografados para comunicação. |Desinstale `talk`  ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r remove-Talk ' |
|Verifique se as permissões em/etc/hosts.allow estão configuradas.<br /><sub>(3.4.4)</sub> |Descrição: é essencial garantir que o `/etc/hosts.allow` arquivo seja protegido contra acesso de gravação não autorizado. Embora seja protegido por padrão, as permissões de arquivo podem ser alteradas inadvertidamente ou por meio de ações mal-intencionadas. |Defina o proprietário e o grupo de/etc/hosts.allow como root e as permissões como 0644 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verifique se as permissões em/etc/hosts.Deny estão configuradas.<br /><sub>(3.4.5)</sub> |Descrição: é essencial garantir que o `/etc/hosts.deny` arquivo seja protegido contra acesso de gravação não autorizado. Embora seja protegido por padrão, as permissões de arquivo podem ser alteradas inadvertidamente ou por meio de ações mal-intencionadas. |Defina o proprietário e o grupo de/etc/hosts.Deny como root e as permissões como 0644 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Garantir a política padrão negar firewall<br /><sub>3.6.2</sub> |Descrição: com uma política de aceitação padrão, o firewall aceitará qualquer pacote que não esteja configurado para ser negado. É mais fácil manter um firewall seguro com uma política de remoção padrão do que com uma política de permissão padrão. |Definir a política padrão para tráfego de entrada, saída e roteado para `deny` ou `reject` conforme apropriado usando o software de firewall |
|A opção nodev/nosuid deve ser habilitada para todas as montagens NFS.<br /><sub>(5)</sub> |Descrição: um invasor pode carregar arquivos executados com um contexto de segurança elevado ou dispositivos especiais por meio do sistema de arquivos remoto |Adicionar as opções nosuid e nodev ao quarto campo (opções de montagem) no/etc/fstab |
|Verifique se os requisitos de criação de senha estão configurados.<br /><sub>5.3.1</sub> |Descrição: senhas fortes protegem os sistemas contra a invasão por meio de métodos de força bruta. |Defina os seguintes pares de chave/valor no PAM apropriado para seu distribuição: minlen = 14, minclass = 4, dcredit =-1, ucredit =-1, ocredit =-1, lcredit =-1 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-password-requirements ' |
|Verifique se o bloqueio de tentativas de senha com falha está configurado.<br /><sub>5.3.2</sub> |Descrição: bloquear IDs de usuário após `n` tentativas de logon consecutivas malsucedidas atenua ataques de senha de força bruta em seus sistemas. |para Ubuntu e Debian, adicione os módulos pam_tally e pam_deny conforme apropriado. Para todos os outros distribuições, consulte a documentação do seu distribuição |
|Desabilitar a instalação e o uso de sistemas de arquivos que não são necessários (CramFs)<br /><sub>(6,1)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no CramFs para elevar privilégios |Adicione um arquivo ao diretório/etc/modprob.d que desabilita o CramFs ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable--kernel-mods ' |
|Desabilitar a instalação e o uso de sistemas de arquivos que não são necessários (freevxfs)<br /><sub>(6,2)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no freevxfs para elevar privilégios |Adicione um arquivo ao diretório/etc/modprob.d que desabilita o freevxfs ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable--kernel-mods ' |
|Verifique se os diretórios principais de todos os usuários existem<br /><sub>(6.2.7)</sub> |Descrição: se o diretório base do usuário não existir ou não estiver atribuído, o usuário será colocado em '/' e não poderá gravar nenhum arquivo ou ter variáveis de ambiente locais definidas. |Se os diretórios base de qualquer usuário não existirem, crie-os e verifique se o respectivo usuário possui o diretório. Os usuários sem um diretório base atribuído devem ser removidos ou atribuídos a um diretório base conforme apropriado. |
|Garantir que os usuários tenham seus diretórios base<br /><sub>(6.2.9)</sub> |Descrição: como o usuário é responsável por arquivos armazenados no diretório base do usuário, o usuário deve ser o proprietário do diretório. |Altere a propriedade de qualquer diretório base que não pertença ao usuário definido para o usuário correto. |
|Verifique se os arquivos de ponto dos usuários não são um grupo ou um mundo gravável.<br /><sub>(6.2.10)</sub> |Descrição: os arquivos de configuração de usuário do grupo ou do mundo gravável podem permitir que usuários mal-intencionados roubem ou modifiquem dados de outros usuários ou tenham privilégios de sistema de outro usuário. |Fazer modificações globais nos arquivos dos usuários sem alertar a comunidade de usuários pode resultar em interrupções inesperadas e usuários insatisfeitos. Portanto, é recomendável que uma política de monitoramento seja estabelecida para relatar permissões de arquivo de ponto de usuário e determinar a ação a ser executada de acordo com a política do site. |
|Certifique-se de que nenhum usuário tenha arquivos. Forward<br /><sub>(6.2.11)</sub> |Descrição: o uso do `.forward` arquivo representa um risco de segurança, pois os dados confidenciais podem ser transferidos inadvertidamente para fora da organização. O `.forward` arquivo também representa um risco, pois pode ser usado para executar comandos que podem executar ações não intencionais. |Fazer modificações globais nos arquivos dos usuários sem alertar a comunidade de usuários pode resultar em interrupções inesperadas e usuários insatisfeitos. Portanto, é recomendável que uma política de monitoramento seja estabelecida para relatar `.forward` arquivos de usuário e determinar a ação a ser executada de acordo com a política do site. |
|Certifique-se de que nenhum usuário tenha arquivos. netrc<br /><sub>(6.2.12)</sub> |Descrição: o `.netrc` arquivo apresenta um risco de segurança significativo, pois armazena senhas em formato não criptografado. Mesmo que o FTP esteja desabilitado, as contas de usuário podem ter trazido `.netrc` os arquivos de outros sistemas, o que poderia representar um risco para esses sistemas |Fazer modificações globais nos arquivos dos usuários sem alertar a comunidade de usuários pode resultar em interrupções inesperadas e usuários insatisfeitos. Portanto, é recomendável que uma política de monitoramento seja estabelecida para relatar `.netrc` arquivos de usuário e determinar a ação a ser executada de acordo com a política do site. |
|Certifique-se de que nenhum usuário tenha arquivos. rhosts<br /><sub>(6.2.14)</sub> |Descrição: essa ação só será significativa se `.rhosts` o suporte for permitido no arquivo `/etc/pam.conf` . Embora os `.rhosts` arquivos sejam ineficazes se o suporte estiver desabilitado no `/etc/pam.conf` , eles poderão ter sido trazidos de outros sistemas e podem conter informações úteis para um invasor para esses outros sistemas. |Fazer modificações globais nos arquivos dos usuários sem alertar a comunidade de usuários pode resultar em interrupções inesperadas e usuários insatisfeitos. Portanto, é recomendável que uma política de monitoramento seja estabelecida para relatar `.rhosts` arquivos de usuário e determinar a ação a ser executada de acordo com a política do site. |
|Verifique se todos os grupos em/etc/passwd existem no/etc/Group<br /><sub>(6.2.15)</sub> |Descrição: os grupos definidos no arquivo/etc/passwd, mas não no arquivo/etc/Group, representam uma ameaça à segurança do sistema, pois as permissões do grupo não são gerenciadas corretamente. |Para cada grupo definido em/etc/passwd, verifique se há um grupo correspondente no/etc/Group |
|Certifique-se de que não existam UIDs duplicadas<br /><sub>(6.2.16)</sub> |Descrição: os usuários devem receber UIDs exclusivos para responsabilidade e garantir as proteções de acesso apropriadas. |Estabeleça UIDs exclusivos e examine todos os arquivos de propriedade dos UIDs compartilhados para determinar a qual UID eles devem pertencer. |
|Garantir que não exista nenhum GIDs duplicado<br /><sub>(6.2.17)</sub> |Descrição: os grupos devem receber GIDs exclusivos para responsabilidade e garantir as proteções de acesso apropriadas. |Estabeleça GIDs exclusivos e examine todos os arquivos pertencentes ao GIDs compartilhado para determinar a qual GID eles devem pertencer. |
|Garantir que não existam nomes de usuário duplicados<br /><sub>(6.2.18)</sub> |Descrição: se um usuário receber um nome de usuário duplicado, ele criará e terá acesso aos arquivos com a primeira UID para esse nome de usuários no `/etc/passwd` . Por exemplo, se ' TEST4 ' tiver um UID de 1000 e uma entrada ' TEST4 ' subsequente tiver um UID de 2000, o logon como ' TEST4 ' usará o UID 1000. Efetivamente, a UID é compartilhada, o que é um problema de segurança. |Estabeleça nomes de usuário exclusivos para os usuários. As propriedade de arquivo refletirão automaticamente a alteração contanto que os usuários tenham UIDs exclusivos. |
|Garantir que não existam grupos duplicados<br /><sub>(6.2.19)</sub> |Descrição: se um grupo for atribuído a um nome de grupo duplicado, ele criará e terá acesso a arquivos com o primeiro GID para esse grupo no `/etc/group` . Efetivamente, o GID é compartilhado, o que é um problema de segurança. |Estabeleça nomes exclusivos para os grupos de usuários. As Propriedade do grupo de arquivos refletirão automaticamente a alteração, contanto que os grupos tenham GIDs exclusivo. |
|Verifique se o grupo de sombra está vazio<br /><sub>(6.2.20)</sub> |Descrição: todos os usuários atribuídos ao grupo de sombra receberão acesso de leitura ao arquivo/etc/shadow. Se os invasores puderem obter acesso de leitura ao `/etc/shadow` arquivo, eles poderão facilmente executar um programa de quebra de senha em relação às senhas com hash para quebrá-los. Outras informações de segurança que são armazenadas no `/etc/shadow` arquivo (como expiração) também podem ser úteis para subverter contas de usuário adicionais. |Remover todos os usuários que formam o grupo de sombra |
|Desabilitar a instalação e o uso de sistemas de arquivos que não são necessários (HFS)<br /><sub>(6,3)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no HFS para elevar privilégios |Adicione um arquivo ao diretório/etc/modprob.d que desabilita o HFS ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable--kernel-mods ' |
|Desabilitar a instalação e o uso de sistemas de arquivos que não são necessários (hfsplus)<br /><sub>(6,4)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no hfsplus para elevar privilégios |Adicione um arquivo ao diretório/etc/modprob.d que desabilita o hfsplus ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable--kernel-mods ' |
|Desabilitar a instalação e o uso de sistemas de arquivos que não são necessários (JFFS2)<br /><sub>(6,5)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no JFFS2 para elevar privilégios |Adicione um arquivo ao diretório/etc/modprob.d que desabilita o JFFS2 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable--kernel-mods ' |
|Os kernels só devem ser compilados de fontes aprovadas.<br /><sub>254</sub> |Descrição: um kernel de uma fonte não aprovada pode conter vulnerabilidades ou backdoors para conceder acesso a um invasor. |Instale o kernel fornecido pelo fornecedor do distribuição. |
|as permissões do arquivo/etc/shadow devem ser definidas como 0400<br /><sub>(11,1)</sub> |Descrição: um invasor que pode recuperar ou manipular senhas com hash de/etc/shadow se ela não estiver protegida corretamente. |Defina as permissões e a propriedade de/etc/shadow * ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-shadow-Perm ' |
|as permissões do arquivo/etc/shadow-devem ser definidas como 0400<br /><sub>(11,2)</sub> |Descrição: um invasor que pode recuperar ou manipular senhas com hash de/etc/shadow-se ela não estiver protegida corretamente. |Defina as permissões e a propriedade de/etc/shadow * ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-shadow-Perm ' |
|as permissões do arquivo/etc/gshadow devem ser definidas como 0400<br /><sub>(11,3)</sub> |Descrição: um invasor pode ingressar em grupos de segurança se esse arquivo não estiver protegido corretamente |Defina as permissões e a propriedade de/etc/gshadow-ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-gshadow-perms ' |
|as permissões do arquivo/etc/gshadow-devem ser definidas como 0400<br /><sub>(11,4)</sub> |Descrição: um invasor pode ingressar em grupos de segurança se esse arquivo não estiver protegido corretamente |Defina as permissões e a propriedade de/etc/gshadow ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-gshadow-perms ' |
|as permissões do arquivo/etc/passwd devem ser 0644<br /><sub>(12,1)</sub> |Descrição: um invasor pode modificar userIDs e shells de logon |Defina as permissões e a propriedade de/etc/passwd ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-passwd-perms ' |
|as permissões do arquivo/etc/Group devem ser 0644<br /><sub>(12,2)</sub> |Descrição: um invasor pode elevar privilégios modificando a associação de grupo |Defina as permissões e a propriedade de/etc/group ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-Group-perms |
|as permissões do arquivo/etc/passwd-devem ser definidas como 0600<br /><sub>(12,3)</sub> |Descrição: um invasor pode ingressar em grupos de segurança se esse arquivo não estiver protegido corretamente |Defina as permissões e a propriedade de/etc/passwd-ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-passwd-perms |
|as permissões do arquivo/etc/Group-devem ser 0644<br /><sub>(12,4)</sub> |Descrição: um invasor pode elevar privilégios modificando a associação de grupo |Defina as permissões e a propriedade de/etc/group-ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-etc-Group-perms |
|O acesso à conta raiz via Su deve ser restrito ao grupo ' raiz '<br /><sub>Abril</sub> |Descrição: um invasor pode escalonar permissões por adivinhação de senha se a su não estiver restrita a usuários no grupo raiz. |Execute o comando '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-Su-Permissions '. Isso adicionará a linha ' auth Required pam_wheel. portanto, use_uid ' ao arquivo '/etc/pam.d/su ' |
|O grupo ' root ' deve existir e conter todos os membros que podem ser su à raiz<br /><sub>22</sub> |Descrição: um invasor pode escalonar permissões por adivinhação de senha se a su não estiver restrita a usuários no grupo raiz. |Crie o grupo raiz por meio do comando ' groupadd-g 0 root ' |
|Não há contas sem senhas<br /><sub>(23,2)</sub> |Descrição: um invasor pode fazer logon em contas sem senha e executar comandos arbitrários. |Usar o comando passwd para definir senhas para todas as contas |
|Contas diferentes da raiz devem ter UIDs exclusivos maiores que zero (0)<br /><sub>24</sub> |Descrição: se uma conta diferente da raiz tiver um UID zero, um invasor poderá comprometer a conta e obter privilégios de raiz. |Atribuir UIDs exclusivos e diferentes de zero a todas as contas não raiz usando ' usermod-u ' |
|O posicionamento aleatório de regiões de memória virtual deve ser habilitado<br /><sub>25</sub> |Descrição: um invasor pode gravar código executável em regiões conhecidas na memória, resultando na elevação de privilégio |Adicione o valor ' 1 ' ou ' 2 ' ao arquivo '/proc/sys/kernel/randomize_va_space ' |
|O suporte de kernel para o recurso do processador XD/NX deve ser habilitado<br /><sub>26</sub> |Descrição: um invasor pode fazer com que um sistema executável código de regiões de dados na memória, resultando na elevação de privilégio. |Confirme se o arquivo '/proc/cpuinfo ' contém o sinalizador ' NX ' |
|O '. ' não deve aparecer na $PATH da raiz<br /><sub>(27,1)</sub> |Descrição: um invasor pode elevar privilégios colocando um arquivo mal-intencionado na $PATH da raiz |Modificar a linha ' Export PATH = ' em/root/.Profile |
|Os diretórios base do usuário devem ser do modo 750 ou mais restritivos<br /><sub>38</sub> |Descrição: um invasor pode recuperar informações confidenciais das pastas base de outros usuários. |Defina as permissões da pasta base como 750 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-Home-dir-Permissions |
|O umask padrão para todos os usuários deve ser definido como 077 em Login. defs<br /><sub>29</sub> |Descrição: um invasor pode recuperar informações confidenciais de arquivos pertencentes a outros usuários. |Execute o comando '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-Default-user-umask '. Isso adicionará a linha ' UMASK 077 ' ao arquivo '/etc/login.defs ' |
|Todos os carregadors de ativação devem ter a proteção por senha habilitada.<br /><sub>31</sub> |Descrição: um invasor com acesso físico pode modificar as opções do carregador de registros, produzindo acesso irrestrito ao sistema |Adicionar uma senha do carregador de inicialização ao arquivo '/boot/grub/grub.cfg ' |
|Verifique se as permissões na configuração do carregador de configurações estão definidas<br /><sub>(31,1)</sub> |Descrição: definir as permissões para leitura e gravação para a raiz impede que usuários não raiz vejam os parâmetros de inicialização ou os alterem. Os usuários não raiz que lêem os parâmetros de inicialização podem ser capazes de identificar os pontos fracos da segurança na inicialização e ser capazes de explorá-los. |Defina o proprietário e o grupo do carregador de origem como raiz: raiz e permissões como 0400 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r carregador de execução-permissões |
|Verifique a autenticação necessária para o modo de usuário único.<br /><sub>(33)</sub> |Descrição: exigir autenticação no modo de usuário único impede que um usuário não autorizado reinicie o sistema em um único usuário para obter privilégios de raiz sem credenciais. |Execute o seguinte comando para definir uma senha para o usuário raiz: `passwd root` |
|Verifique se o envio de redirecionamento de pacotes está desabilitado.<br /><sub>(38,3)</sub> |Descrição: um invasor pode usar um host comprometido para enviar redirecionamentos de ICMP inválidos para outros dispositivos de roteador em uma tentativa de corromper o roteamento e fazer com que os usuários acessem um sistema configurado pelo invasor em vez de um sistema válido. |Defina os seguintes parâmetros em/etc/sysctl.conf: ' net.ipv4.conf.all.send_redirects = 0 ' e ' net.ipv4.conf.default.send_redirects = 0 ' ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Send-redirects |
|O envio de redirecionamentos ICMP deve ser desabilitado para todas as interfaces. (net.ipv4.conf.default.accept_redirects = 0)<br /><sub>(38,4)</sub> |Descrição: um invasor pode alterar a tabela de roteamento do sistema, redirecionando o tráfego para um destino alternativo |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-redirects '. |
|O envio de redirecionamentos ICMP deve ser desabilitado para todas as interfaces. (net.ipv4.conf.default.secure_redirects = 0)<br /><sub>(38,5)</sub> |Descrição: um invasor pode alterar a tabela de roteamento do sistema, redirecionando o tráfego para um destino alternativo |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Secure-redirectors ' |
|A aceitação de pacotes roteados de origem deve ser desabilitada para todas as interfaces. (net.ipv4.conf.all.accept_source_route = 0)<br /><sub>(40,1)</sub> |Descrição: um invasor pode redirecionar o tráfego para fins mal-intencionados. |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-Source-Route ' |
|A aceitação de pacotes roteados de origem deve ser desabilitada para todas as interfaces. (net.ipv6.conf.all.accept_source_route = 0) ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-Source-Route '<br /><sub>(40,2)</sub> |Descrição: um invasor pode redirecionar o tráfego para fins mal-intencionados. |Execute `sysctl -w key=value` e defina como um valor em conformidade. |
|Ignorar respostas de ICMP falsas para difusões deve ser habilitado. (net.ipv4.icmp_ignore_bogus_error_responses = 1)<br /><sub>(43)</sub> |Descrição: um invasor pode executar um ataque de ICMP resultante no DoS |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-ICMP-ignore-falso-Error-Responses ' |
|A ignoração de solicitações de eco ICMP (pings) enviadas para endereços de difusão/multicast deve ser habilitada. (net.ipv4.icmp_echo_ignore_broadcasts = 1)<br /><sub>(44)</sub> |Descrição: um invasor pode executar um ataque de ICMP resultante no DoS |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-ICMP-echo-ignore-transmissões ' |
|O registro em log de pacotes Martian (aqueles com endereços impossíveis) deve ser habilitado para todas as interfaces. (net.ipv4.conf.all.log_martians = 1)<br /><sub>(45,1)</sub> |Descrição: um invasor pode enviar tráfego de endereços falsificados sem ser detectado |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-log-Martians ' |
|A execução da validação de origem por caminho inverso deve ser habilitada para todas as interfaces. (net.ipv4.conf.all.rp_filter = 1)<br /><sub>(46,1)</sub> |Descrição: o sistema aceitará o tráfego de endereços que são unroutable. |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-RP-Filter ' |
|A execução da validação de origem por caminho inverso deve ser habilitada para todas as interfaces. (net.ipv4.conf.default.rp_filter = 1)<br /><sub>(46,2)</sub> |Descrição: o sistema aceitará o tráfego de endereços que são unroutable. |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-RP-Filter ' |
|O TCP syncookies deve ser habilitado. (net.ipv4.tcp_syncookies = 1)<br /><sub>(47)</sub> |Descrição: um invasor pode executar um DoS sobre TCP |Execute `sysctl -w key=value` e defina como um valor em conformidade ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-TCP-syncookies ' |
|O sistema não deve atuar como um farejador de rede.<br /><sub>(48)</sub> |Descrição: um invasor pode usar interfaces promíscuo para detectar o tráfego de rede |O modo promíscuo é habilitado por meio de uma entrada ' promisc ' em '/etc/network/interfaces ' ou '/etc/rc.local. ' Verifique ambos os arquivos e remova essa entrada. |
|Todas as interfaces sem fio devem ser desabilitadas.<br /><sub>(49)</sub> |Descrição: um invasor pode criar um AP falso para interceptar transmissões. |Confirme se todas as interfaces sem fio estão desabilitadas em '/etc/network/interfaces ' |
|O protocolo IPv6 deve ser habilitado.<br /><sub>(50)</sub> |Descrição: isso é necessário para a comunicação em redes modernas. |Abra/etc/sysctl.conf e confirme se ' net.ipv6.conf.all.disable_ipv6 ' e ' net.ipv6.conf.default.disable_ipv6 ' estão definidos como 0 |
|Verifique se o DCCP está desabilitado<br /><sub>(54)</sub> |Descrição: se o protocolo não for necessário, é recomendável que os drivers não sejam instalados para reduzir a superfície potencial de ataque. |Edite ou crie um arquivo no `/etc/modprobe.d/` diretório que termina em. conf e adicione `install dccp /bin/true` , em seguida, descarregue o módulo DCCP ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unding-kernel-mods ' |
|Verifique se SCTP está desabilitado<br /><sub>(55)</sub> |Descrição: se o protocolo não for necessário, é recomendável que os drivers não sejam instalados para reduzir a superfície potencial de ataque. |Edite ou crie um arquivo no `/etc/modprobe.d/` diretório que termina em. conf e adicione `install sctp /bin/true` , em seguida, descarregue o módulo SCTP ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unding-kernel-mods ' |
|Desabilite o suporte para RDS.<br /><sub>(56)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no RDS para comprometer o sistema |Edite ou crie um arquivo no `/etc/modprobe.d/` diretório que termina em. conf e adicione `install rds /bin/true` , em seguida, descarregue o módulo RDS ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unding-kernel-mods ' |
|Verifique se o TIPC está desabilitado<br /><sub>(57)</sub> |Descrição: se o protocolo não for necessário, é recomendável que os drivers não sejam instalados para reduzir a superfície potencial de ataque. |Edite ou crie um arquivo no `/etc/modprobe.d/` diretório que termina em. conf e adicione `install tipc /bin/true` , em seguida, descarregue o módulo TIPC ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unding-kernel-mods ' |
|Verifique se o registro em log está configurado<br /><sub>(60)</sub> |Descrição: uma grande quantidade de informações importantes relacionadas à segurança é enviada por meio do `rsyslog` (por exemplo, tentativas de Su bem-sucedidas e com falha, tentativas de logon com falha, tentativas de logon raiz, etc.). |Configurar syslog, rsyslog ou syslog-ng conforme apropriado |
|O pacote syslog, rsyslog ou syslog-ng deve ser instalado.<br /><sub>(61)</sub> |Descrição: os problemas de confiabilidade e segurança não serão registrados, impedindo o diagnóstico adequado. |Instale o pacote rsyslog ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r install-rsyslog ' |
|Verifique se um serviço de registro em log está habilitado<br /><sub>(62)</sub> |Descrição: é imperativo ter a capacidade de registrar eventos em um nó. |Habilite o pacote rsyslog ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-rsyslog ' |
|As permissões de arquivo para todos os arquivos de log do rsyslog devem ser definidas como 640 ou 600.<br /><sub>(63)</sub> |Descrição: um invasor pode cobrir a atividade manipulando logs |Adicione a linha ' $FileCreateMode 0640 ' ao arquivo '/etc/rsyslog.conf ' |
|Verifique se os arquivos de configuração do agente estão restritos.<br /><sub>(63,1)</sub> |Descrição: é importante garantir que os arquivos de log existam e tenham as permissões corretas para garantir que os dados confidenciais do syslog sejam arquivados e protegidos. |Defina os arquivos de configuração do agente para 0640 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r logger-config-file-permissions ' |
|Todos os arquivos de log do rsyslog devem pertencer ao grupo ADM.<br /><sub>(64)</sub> |Descrição: um invasor pode cobrir a atividade manipulando logs |Adicione a linha ' $FileGroup ADM ' ao arquivo '/etc/rsyslog.conf ' |
|Todos os arquivos de log do rsyslog devem pertencer ao usuário do syslog.<br /><sub>(65)</sub> |Descrição: um invasor pode cobrir a atividade manipulando logs |Adicione a linha ' $FileOwner syslog ' ao arquivo '/etc/rsyslog.conf ' ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r syslog-Owner |
|Rsyslog não deve aceitar mensagens remotas.<br /><sub>(67)</sub> |Descrição: um invasor pode injetar mensagens no syslog, causando um DoS ou uma distração de outra atividade |Remova as linhas ' $ModLoad imudp ' e ' $ModLoad imtcp ' do arquivo '/etc/rsyslog.conf ' |
|O serviço logrotate (rodízio do syslog) deve ser habilitado.<br /><sub>(68)</sub> |Descrição: os arquivos de log podem crescer sem limites e consumir todo o espaço em disco |Instale o pacote logrotate e confirme se a entrada logrotate cron está ativa (chmod 755/etc/cron.Daily/logrotate; proprietário da raiz: root/etc/cron.Daily/logrotate) |
|O serviço rlogin deve ser desabilitado.<br /><sub>(69)</sub> |Descrição: um invasor pode obter acesso, ignorando requisitos estritos de autenticação |Remova o serviço inetd. |
|Desabilite o inetd, a menos que necessário. (inetd)<br /><sub>(70,1)</sub> |Descrição: um invasor pode explorar uma vulnerabilidade em um serviço inetd para obter acesso |Desinstalar o serviço inetd (apt-get remove inetd) |
|Desabilite o xinetd, a menos que necessário. (xinetd)<br /><sub>(70,2)</sub> |Descrição: um invasor pode explorar uma vulnerabilidade em um serviço xinetd para obter acesso |Desinstalar o serviço inetd (apt-get remove xinetd) |
|Instale o inetd somente se apropriado e exigido por seu distribuição. Proteja de acordo com os padrões atuais de proteção. (se necessário)<br /><sub>(71,1)</sub> |Descrição: um invasor pode explorar uma vulnerabilidade em um serviço inetd para obter acesso |Desinstalar o serviço inetd (apt-get remove inetd) |
|Instale o xinetd somente se apropriado e exigido por seu distribuição. Proteja de acordo com os padrões atuais de proteção. (se necessário)<br /><sub>(71,2)</sub> |Descrição: um invasor pode explorar uma vulnerabilidade em um serviço xinetd para obter acesso |Desinstalar o serviço inetd (apt-get remove xinetd) |
|O serviço Telnet deve ser desabilitado.<br /><sub>(72)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar sessões de Telnet não criptografadas |Remova ou comente a entrada Telnet no arquivo '/etc/inetd.conf ' |
|Todos os pacotes Telnet devem ser desinstalados.<br /><sub>(73)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar sessões de Telnet não criptografadas |Desinstalar todos os pacotes Telnet |
|O serviço RCP/rsh deve ser desabilitado.<br /><sub>(74)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar sessões não criptografadas |Remover ou comentar a entrada do Shell no arquivo '/etc/inetd.conf ' |
|O pacote rsh-Server deve ser desinstalado.<br /><sub>(77)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar sessões rsh não criptografadas |Desinstale o pacote rsh-Server (apt-get remove rsh-Server) |
|O serviço ypbind deve ser desabilitado.<br /><sub>(78)</sub> |Descrição: um invasor pode recuperar informações confidenciais do serviço ypbind |Desinstalar o pacote NIS (apt-get remover NIS) |
|O pacote NIS deve ser desinstalado.<br /><sub>(79)</sub> |Descrição: um invasor pode recuperar informações confidenciais do serviço NIS |Desinstalar o pacote NIS (apt-get remover NIS) |
|O serviço TFTP deve ser desabilitado.<br /><sub>(80)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar uma sessão não criptografada |Remover a entrada de TFTP do arquivo '/etc/inetd.conf ' |
|O pacote do tftpd deve ser desinstalado.<br /><sub>(81)</sub> |Descrição: um invasor pode bisbilhotar ou seqüestrar uma sessão não criptografada |Desinstalar o pacote do tftpd (apt-get remover o tftpd) |
|O pacote leitura antecipada-Fedora deve ser desinstalado.<br /><sub>(82)</sub> |Descrição: nenhuma exposição substancial, mas também não é um benefício substancial |Desinstalar o pacote leitura antecipada-Fedora (apt-get remove leitura antecipada-Fedora) |
|O serviço Bluetooth/Hidd deve ser desabilitado.<br /><sub>(84)</sub> |Descrição: um invasor pode interceptar ou manipular comunicações sem fio. |Desinstalar o pacote Bluetooth (apt-get remover Bluetooth) |
|O serviço ISDN deve ser desabilitado.<br /><sub>(86)</sub> |Descrição: um invasor pode usar um modem para obter acesso não autorizado |Desinstalar o pacote isdnutils-base (apt-get remove isdnutils-base) |
|O pacote isdnutils-base deve ser desinstalado.<br /><sub>(87)</sub> |Descrição: um invasor pode usar um modem para obter acesso não autorizado |Desinstalar o pacote isdnutils-base (apt-get remove isdnutils-base) |
|O serviço kdump deve ser desabilitado.<br /><sub>(88)</sub> |Descrição: um invasor pode analisar uma falha do sistema anterior para recuperar informações confidenciais |Desinstale o pacote kdump-Tools (apt-obter remover kdump-Tools) |
|A rede Zeroconf deve ser desabilitada.<br /><sub>(89)</sub> |Descrição: um invasor pode usar o abuso para obter informações sobre sistemas de rede ou para falsificar solicitações de DNS devido a falhas em seu modelo de confiança |Para RedHat, CentOS e Oracle: Adicionar `NOZEROCONF=yes or no` ao/etc/sysconfig/network. Para todos os outros distribuições: Remova as entradas ' IPv4LL ' no arquivo '/etc/network/interfaces ' ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Zeroconf ' |
|O serviço de cronização deve ser habilitado.<br /><sub>(90)</sub> |Descrição: cron é exigido por quase todos os sistemas para tarefas de manutenção regulares |Instale o pacote cron (apt-get install-y cron) e confirme se o arquivo '/etc/init/cron.conf ' contém a linha ' start on runlevel [2345] ' |
|As permissões de arquivo para/etc/anacrontab devem ser definidas como root: raiz 600.<br /><sub>(91)</sub> |Descrição: um invasor pode manipular esse arquivo para impedir tarefas agendadas ou executar tarefas mal-intencionadas |Defina a propriedade e as permissões em/etc/anacrontab ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-anacrontab-permes ' |
|Verifique se as permissões em/etc/cron.d estão configuradas.<br /><sub>(93)</sub> |Descrição: conceder acesso de gravação a este diretório para usuários sem privilégios pode fornecer a eles os meios para obter privilégios elevados não autorizados. Conceder acesso de leitura a esse diretório pode dar a um usuário sem privilégios informações sobre como obter privilégios elevados ou burlar controles de auditoria. |Defina o proprietário e o grupo de/etc/chron.d como raiz e permissões como 0700 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms ' |
|Verifique se as permissões em/etc/cron.Daily estão configuradas.<br /><sub>(94)</sub> |Descrição: conceder acesso de gravação a este diretório para usuários sem privilégios pode fornecer a eles os meios para obter privilégios elevados não autorizados. Conceder acesso de leitura a esse diretório pode dar a um usuário sem privilégios informações sobre como obter privilégios elevados ou burlar controles de auditoria. |Defina o proprietário e o grupo de/etc/chron.Daily como raiz e permissões como 0700 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verifique se as permissões em/etc/cron.Hourly estão configuradas.<br /><sub>(95)</sub> |Descrição: conceder acesso de gravação a este diretório para usuários sem privilégios pode fornecer a eles os meios para obter privilégios elevados não autorizados. Conceder acesso de leitura a esse diretório pode dar a um usuário sem privilégios informações sobre como obter privilégios elevados ou burlar controles de auditoria. |Defina o proprietário e o grupo de/etc/chron.Hourly como raiz e permissões como 0700 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verifique se as permissões em/etc/cron.Monthly estão configuradas.<br /><sub>(96)</sub> |Descrição: conceder acesso de gravação a este diretório para usuários sem privilégios pode fornecer a eles os meios para obter privilégios elevados não autorizados. Conceder acesso de leitura a esse diretório pode dar a um usuário sem privilégios informações sobre como obter privilégios elevados ou burlar controles de auditoria. |Defina o proprietário e o grupo de/etc/chron.Monthly como raiz e permissões como 0700 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verifique se as permissões em/etc/cron.Weekly estão configuradas.<br /><sub>(97)</sub> |Descrição: conceder acesso de gravação a este diretório para usuários sem privilégios pode fornecer a eles os meios para obter privilégios elevados não autorizados. Conceder acesso de leitura a esse diretório pode dar a um usuário sem privilégios informações sobre como obter privilégios elevados ou burlar controles de auditoria. |Defina o proprietário e o grupo de/etc/chron.Weekly como raiz e permissões como 0700 ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verifique se at/cron está restrito a usuários autorizados<br /><sub>(98)</sub> |Descrição: em muitos sistemas, somente o administrador do sistema está autorizado a agendar `cron` trabalhos. Usar o `cron.allow` arquivo para controlar quem pode executar `cron` trabalhos impõe essa política. É mais fácil gerenciar uma lista de permissões do que uma lista de negações. Em uma lista de negações, você pode potencialmente adicionar uma ID de usuário ao sistema e esquecer de adicioná-la aos arquivos Deny. |Substitua/etc/cron.Deny e/etc/at.Deny por seus respectivos `allow` arquivos |
|Verifique se a faixa de aviso de logon remoto está configurada corretamente.<br /><sub>(111)</sub> |Descrição: mensagens de aviso informam os usuários que estão tentando fazer logon no sistema de seu status legal em relação ao sistema e devem incluir o nome da organização que possui o sistema e as políticas de monitoramento em vigor. A exibição de informações de nível de patch e do sistema operacional em faixas de logon também tem o efeito colateral de fornecer informações detalhadas do sistema para invasores tentando direcionar explorações específicas de um sistema. Os usuários autorizados podem obter essas informações facilmente executando o `uname -a` comando quando tiverem feito logon. |Remova todas as instâncias de \m \r \s e \v do arquivo/etc/issue.net |
|Verifique se a faixa de aviso de logon local está configurada corretamente.<br /><sub>(111,1)</sub> |Descrição: mensagens de aviso informam os usuários que estão tentando fazer logon no sistema de seu status legal em relação ao sistema e devem incluir o nome da organização que possui o sistema e as políticas de monitoramento em vigor. A exibição de informações de nível de patch e do sistema operacional em faixas de logon também tem o efeito colateral de fornecer informações detalhadas do sistema para invasores tentando direcionar explorações específicas de um sistema. Os usuários autorizados podem obter essas informações facilmente executando o `uname -a` comando quando tiverem feito logon. |Remova todas as instâncias de \m \r \s e \v do arquivo/etc/issue |
|O serviço Avahi-daemon deve ser desabilitado.<br /><sub>(114)</sub> |Descrição: um invasor pode usar uma vulnerabilidade no daemon do Avahi para obter acesso |Desabilite o serviço Avahi-daemon ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Avahi-daemon ' |
|O serviço CUPS deve ser desabilitado.<br /><sub>(115)</sub> |Descrição: um invasor pode usar uma falha no serviço CUPS para elevar privilégios |Desabilite o serviço CUPS ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-cups ' |
|O serviço ISC-dhcpd deve ser desabilitado.<br /><sub>(116)</sub> |Descrição: um invasor pode usar o dhcpd para fornecer informações com falha aos clientes, interferindo com a operação normal. |Remova o pacote ISC-DHCP-Server (apt-get remove ISC-DHCP-Server) |
|O pacote ISC-DHCP-Server deve ser desinstalado.<br /><sub>(117)</sub> |Descrição: um invasor pode usar o dhcpd para fornecer informações com falha aos clientes, interferindo com a operação normal. |Remova o pacote ISC-DHCP-Server (apt-get remove ISC-DHCP-Server) |
|O pacote sendmail deve ser desinstalado.<br /><sub>(120)</sub> |Descrição: um invasor pode usar este sistema para enviar emails com conteúdo mal-intencionado a outros usuários |Desinstalar o pacote sendmail (apt-get remover sendmail) |
|O pacote de sufixo deve ser desinstalado.<br /><sub>(121)</sub> |Descrição: um invasor pode usar este sistema para enviar emails com conteúdo mal-intencionado a outros usuários |Desinstale o pacote de sufixo (apt-get remove sufixo) ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r remove-sufixo ' |
|O sufixo de escuta de rede deve ser desabilitado conforme apropriado.<br /><sub>(122)</sub> |Descrição: um invasor pode usar este sistema para enviar emails com conteúdo mal-intencionado a outros usuários |Adicione a linha ' inet_interfaces localhost ' ao arquivo '/etc/postfix/main.cf ' |
|O serviço LDAP deve ser desabilitado.<br /><sub>(124)</sub> |Descrição: um invasor pode manipular o serviço LDAP nesse host para distribuir dados falsos para clientes LDAP |Desinstalar o pacote slapd (apt-get remove slapd) |
|O serviço rpcgssd deve ser desabilitado.<br /><sub>(126)</sub> |Descrição: um invasor pode usar uma falha no rpcgssd/NFS para obter acesso |Desabilite o serviço rpcgssd ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcgssd ' |
|O serviço rpcidmapd deve ser desabilitado.<br /><sub>(127)</sub> |Descrição: um invasor pode usar uma falha no idmapd/NFS para obter acesso |Desabilite o serviço rpcidmapd ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcidmapd ' |
|O serviço portmap deve ser desabilitado.<br /><sub>(129)</sub> |Descrição: um invasor pode usar uma falha no portmap para obter acesso |Desabilite o serviço rpcbind ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcbind ' |
|O serviço rpcsvcgssd deve ser desabilitado.<br /><sub>(130)</sub> |Descrição: um invasor pode usar uma falha no rpcsvcgssd para obter acesso |Remova a linha ' NEED_SVCGSSD = Yes ' do arquivo '/etc/inetd.conf ' |
|O serviço nomeado deve ser desabilitado.<br /><sub>(131)</sub> |Descrição: um invasor pode usar o serviço DNS para distribuir dados falsos para clientes |Desinstalar o pacote bind9 (apt-get remove bind9) |
|O pacote de associação deve ser desinstalado.<br /><sub>(132)</sub> |Descrição: um invasor pode usar o serviço DNS para distribuir dados falsos para clientes |Desinstalar o pacote bind9 (apt-get remove bind9) |
|O serviço Dovecot deve ser desabilitado.<br /><sub>(137)</sub> |Descrição: o sistema pode ser usado como um servidor IMAP/POP3 |Desinstalar o pacote Dovecot-Core (apt-get remove Dovecot-Core) |
|O pacote Dovecot deve ser desinstalado.<br /><sub>(138)</sub> |Descrição: o sistema pode ser usado como um servidor IMAP/POP3 |Desinstalar o pacote Dovecot-Core (apt-get remove Dovecot-Core) |
|Certifique-se `+` de que não exista nenhuma entrada herdada em/etc/passwd<br /><sub>(156,1)</sub> |Descrição: um invasor pode obter acesso usando o nome de usuário ' + ' sem senha |Remova todas as entradas em/etc/passwd que começam com ' +: ' |
|Certifique-se `+` de que não exista nenhuma entrada herdada em/etc/shadow<br /><sub>(156,2)</sub> |Descrição: um invasor pode obter acesso usando o nome de usuário ' + ' sem senha |Remova todas as entradas em/etc/shadow que começam com ' +: ' |
|Certifique-se `+` de que não exista nenhuma entrada herdada em/etc/Group<br /><sub>(156,3)</sub> |Descrição: um invasor pode obter acesso usando o nome de usuário ' + ' sem senha |Remova todas as entradas em/etc/Group que começam com ' +: ' |
|Garanta que a expiração da senha seja de 365 dias ou menos.<br /><sub>(157,1)</sub> |Descrição: a janela de oportunidade de um invasor para aproveitar as credenciais comprometidas ou comprometer com êxito as credenciais por meio de um ataque de força bruta online é limitada pela idade da senha. Portanto, a redução da idade máxima de uma senha também reduz a janela de oportunidade de um invasor. |Defina o `PASS_MAX_DAYS` parâmetro para não mais de 365 em `/etc/login.defs`  ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r configure-password-Policy-Max-Days ' |
|Verifique se os dias de aviso de expiração de senha são 7 ou mais.<br /><sub>(157,2)</sub> |Descrição: fornecer um aviso antecipado de que uma senha expirará oferece aos usuários a hora de considerar uma senha segura. Os usuários não conseguiram descobrir que podem escolher uma senha simples ou anotá-la onde ela possa ser descoberta. |Defina o `PASS_WARN_AGE` parâmetro para 7 `/etc/login.defs`  ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r configure-password-Policy-Warn-age ' |
|Verifique se a reutilização de senha é limitada.<br /><sub>(157,5)</sub> |Descrição: forçar os usuários a não reutilizarem suas últimas 5 senhas tornam menos provável que um invasor possa adivinhar a senha. |Verifique se a opção ' lembrar ' está definida como pelo menos 5 em/etc/pam.d/common-Password ou/etc/pam.d/password_auth e/etc/pam.d/system_auth ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r configure-password-Policy-History ' |
|Verifique se o algoritmo de hash de senha é SHA-512<br /><sub>(157,11)</sub> |Descrição: o algoritmo SHA-512 fornece um hash muito mais forte que o MD5, fornecendo, assim, proteção adicional ao sistema, aumentando o nível de esforço de um invasor para determinar as senhas com êxito. Observação: essas alterações se aplicam somente às contas configuradas no sistema local. |Defina o algoritmo de hash de senha como SHA512. Muitas distribuições fornecem ferramentas para atualizar a configuração do PAM, consultar a documentação para obter detalhes. Se nenhuma ferramenta for fornecida, edite o `/etc/pam.d/` arquivo de configuração apropriado e adicione ou modifique as `pam_unix.so` linhas para incluir a opção SHA512: ``` password sufficient pam_unix.so sha512 ``` |
|Verifique se os dias mínimos entre as alterações de senha são 7 ou mais.<br /><sub>(157,12)</sub> |Descrição: ao restringir a frequência de alterações de senha, um administrador pode impedir que os usuários alterem a senha repetidamente em uma tentativa de burlar os controles de reutilização de senha. |Defina o `PASS_MIN_DAYS` parâmetro para 7 em `/etc/login.defs` : `PASS_MIN_DAYS 7` . Modifique os parâmetros do usuário para todos os usuários com uma senha definida para corresponder: `chage --mindays 7`  ou execute '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-Pass-min-Days ' |
|Verifique se a data de alteração da última senha de todos os usuários está no passado<br /><sub>(157,14)</sub> |Descrição: se uma data de alteração de senha gravada por usuários estiver no futuro, ela poderá ignorar qualquer expiração de senha definida. |Verifique se o bloqueio de senha inativo tem 30 dias ou menos execute o seguinte comando para definir o período de inatividade de senha padrão como 30 dias: ``` # useradd -D -f 30 ``` Modificar parâmetros de usuário para todos os usuários com uma senha definida para correspondência: ``` # chage --inactive 30  ``` |
|Verifique se as contas do sistema são de não logon<br /><sub>(157,15)</sub> |Descrição: é importante garantir que as contas que não estão sendo usadas por usuários regulares sejam impedidas de serem usadas para fornecer um shell interativo. Por padrão, o Ubuntu define o campo de senha para essas contas como uma cadeia de caracteres inválida, mas também é recomendável que o campo Shell no arquivo de senha seja definido como `/usr/sbin/nologin` . Isso impede que a conta seja usada potencialmente para executar qualquer comando. |Defina o Shell para todas as contas retornadas pelo script de auditoria para `/sbin/nologin` |
|Verifique se o grupo padrão da conta raiz é GID 0<br /><sub>(157,16)</sub> |Descrição: usar o GID 0 para a `_root_ ` conta ajuda a impedir que `_root_` arquivos de propriedade se tornem acidentalmente acessíveis a usuários sem privilégios. |Execute o seguinte comando para definir o `root` grupo padrão do usuário para GID `0` : ``` # usermod -g 0 root ``` |
|Verifique se a raiz é a única conta UID 0<br /><sub>(157,18)</sub> |Descrição: esse acesso deve ser limitado apenas à conta padrão `root ` e somente do console do sistema. O acesso administrativo deve ser por meio de uma conta sem privilégios usando um mecanismo aprovado. |Remova qualquer usuário que não seja `root` com UID `0` ou atribua a eles um novo UID, se apropriado. |
|Remover pacotes desnecessários<br /><sub>(158)</sub> |Descrição:  |Execute '/opt/Microsoft/omsagent/plugin/omsremediate-r remove-paisagem-comum |
|Remover contas desnecessárias<br /><sub>(159)</sub> |Descrição: para conformidade |Remover as contas desnecessárias |
|Verifique se o serviço auditado está habilitado<br /><sub>(162)</sub> |Descrição: a captura de eventos do sistema fornece aos administradores do sistema informações para que eles determinem se o acesso não autorizado ao sistema está ocorrendo. |Instalar o pacote de auditoria (systemctl habilitar auditoria) |
|Executar serviço auditado<br /><sub>(163)</sub> |Descrição: a captura de eventos do sistema fornece aos administradores do sistema informações para que eles determinem se o acesso não autorizado ao sistema está ocorrendo. |Executar serviço auditado (systemctl iniciar auditoria) |
|Verifique se o servidor SNMP não está habilitado<br /><sub>(179)</sub> |Descrição: o servidor SNMP pode se comunicar usando SNMP v1, que transmite dados em claro e não requer autenticação para executar comandos. A menos que seja absolutamente necessário, é recomendável que o serviço SNMP não seja usado. Se o SNMP for necessário, o servidor deverá ser configurado para não permitir o SNMP v1. |Execute um dos seguintes comandos para desabilitar o `snmpd` : ``` # chkconfig snmpd off ``` ``` # systemctl disable snmpd `````` # update-rc.d snmpd disable ``` |
|Verifique se o serviço rsync não está habilitado<br /><sub>(181)</sub> |Descrição: o `rsyncd` serviço apresenta um risco de segurança, pois usa protocolos não criptografados para comunicação. |Execute um dos seguintes comandos para desabilitar `rsyncd` : `chkconfig rsyncd off` , `systemctl disable rsyncd` `update-rc.d rsyncd disable` ou executar '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rsysnc ' |
|Verifique se o servidor NIS não está habilitado<br /><sub>(182)</sub> |Descrição: o serviço NIS é inerentemente um sistema inseguro que foi vulnerável a ataques de DOS, estouros de buffer e tem autenticação inadequada para consultar mapas NIS. O NIS geralmente foi substituído por tais protocolos como LDAP (Lightweight Directory Access Protocol). É recomendável que o serviço seja desabilitado e outros serviços mais seguros sejam usados |Execute um dos seguintes comandos para desabilitar o `ypserv` : ``` # chkconfig ypserv off ``` ``` # systemctl disable ypserv `````` # update-rc.d ypserv disable ``` |
|Verifique se o cliente rsh não está instalado<br /><sub>(183)</sub> |Descrição: esses clientes herdados contêm várias exposições de segurança e foram substituídos pelo pacote SSH mais seguro. Mesmo que o servidor seja removido, é melhor garantir que os clientes também sejam removidos para impedir que os usuários tentem usar esses comandos inadvertidamente e, portanto, expondo suas credenciais. Observe que a remoção do `rsh ` pacote remove os clientes `rsh` para `rcp ` e `rlogin` . |Desinstale `rsh` o usando o Gerenciador de pacotes apropriado ou a instalação manual: ``` yum remove rsh ``` ``` apt-get remove rsh `````` zypper remove rsh ``` |
|Desabilitar SMB v1 com samba<br /><sub>(185)</sub> |Descrição: o SMB v1 tem vulnerabilidades sérias e conhecidas e não criptografa dados em trânsito. Se ele precisar ser usado para a substituição de motivos comerciais, é altamente recomendável que outras atenuações sejam identificadas para compensar o uso desse protocolo.  |Se o samba não estiver em execução, remova o pacote, caso contrário deve haver uma linha na seção [global] de/etc/samba/smb.conf: min Protocol = SMB2 ou Run '/opt/Microsoft/omsagent/plugin/omsremediate-r Set-SMB-min-Version |

> [!NOTE]
> A disponibilidade de definições de configuração de convidado Azure Policy específicas pode variar no Azure governamental e em outras nuvens nacionais.

## <a name="next-steps"></a>Próximas etapas

Artigos adicionais sobre Azure Policy e configuração de convidado:

- [Configuração de convidado do Azure Policy](../concepts/guest-configuration.md).
- Visão geral da [Conformidade Regulatória](../concepts/regulatory-compliance.md).
- Veja outros exemplos em [Amostras do Azure Policy](./index.md).
- Revisar [Compreendendo os efeitos da política](../concepts/effects.md).
- Saiba como [corrigir recursos fora de conformidade](../how-to/remediate-resources.md).
