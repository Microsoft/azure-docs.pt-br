---
title: Avaliação de vulnerabilidade de VM BYOL na central de segurança do Azure
description: Implante uma solução de avaliação de vulnerabilidade BYOL em suas máquinas virtuais do Azure para obter recomendações na central de segurança do Azure que podem ajudá-lo a proteger suas máquinas virtuais.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 11/22/2020
ms.author: memildin
ms.openlocfilehash: 3bd4560939923661e7c530fddd44dd948ef9db8e
ms.sourcegitcommit: 436518116963bd7e81e0217e246c80a9808dc88c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/27/2021
ms.locfileid: "98916431"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>Implantar uma solução de avaliação de vulnerabilidade de BYOL (traga sua própria licença)

Se você tiver habilitado o **Azure defender para servidores**, será possível usar a ferramenta de avaliação de vulnerabilidade interna da central de segurança do Azure, conforme descrito em [Verificador de vulnerabilidades integradas para máquinas virtuais](./deploy-vulnerability-assessment-vm.md). Essa ferramenta é integrada ao Azure defender e não requer licenças externas – tudo é manipulado diretamente na central de segurança. Além disso, o scanner integrado dá suporte a computadores habilitados para Arc do Azure.

Como alternativa, talvez você queira implantar sua própria solução de avaliação de vulnerabilidade licenciada de forma privada de [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7](https://www.rapid7.com/products/insightvm/). Você pode instalar uma dessas soluções de parceiros em várias VMs que pertencem à mesma assinatura (mas não a máquinas habilitadas para o Arc do Azure).

## <a name="availability"></a>Disponibilidade

|Aspecto|Detalhes|
|----|:----|
|Estado da versão:|GA (Disponibilidade Geral)|
|Tipos de máquina (cenários híbridos):|![Sim](./media/icons/yes-icon.png) Máquinas virtuais do Azure<br>![Não](./media/icons/no-icon.png) Computadores habilitados para o Azure Arc|
|Preço:|Gratuita|
|Funções e permissões necessárias:|O **proprietário do recurso** pode implantar o scanner<br>O **leitor de segurança** pode exibir as descobertas|
|Nuvens:|![Sim](./media/icons/yes-icon.png) Nuvens comerciais<br>![Não](./media/icons/no-icon.png) Nacionais/soberanas (US Gov, China Gov, outros Gov)|
|||


## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>Implantar uma solução BYOL do portal do Azure

As opções de BYOL referem-se a soluções de avaliação de vulnerabilidades de terceiros com suporte. Atualmente, Qualys e Rapid7 são provedores com suporte.

As soluções com suporte relatam dados de vulnerabilidade para a plataforma de gerenciamento do parceiro. Por sua vez, essa plataforma fornece dados de monitoramento de vulnerabilidade e integridade para a Central de Segurança. Você pode identificar VMs vulneráveis no painel da central de segurança e alternar para o console de gerenciamento de parceiros diretamente da central de segurança para obter mais relatórios e informações.

1. No [portal do Azure](https://azure.microsoft.com/features/azure-portal/), abra a **Central de Segurança**.

1. No menu da central de segurança, abra a página **recomendações** .

1. Selecione a recomendação que **uma solução de avaliação de vulnerabilidade deve ser habilitada em suas máquinas virtuais**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Os agrupamentos dos computadores na * * uma solução de avaliação de vulnerabilidade deve ser habilitada na página de recomendação de suas máquinas virtuais * *" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Suas VMs serão exibidas em um ou mais dos seguintes grupos:

    * **Recursos íntegros** – a central de segurança detectou uma solução de avaliação de vulnerabilidade em execução nessas VMS.
    * **Recursos não íntegros** – uma extensão do verificador de vulnerabilidades pode ser implantada nessas VMS. 
    * **Recursos não aplicáveis** – essas VMs não podem ter uma extensão de verificador de vulnerabilidade implantada.

1. Na lista de computadores não íntegros, selecione aqueles para receber uma solução de avaliação de vulnerabilidade e selecione **corrigir**.

    >[!IMPORTANT]
    > Dependendo de sua configuração, você só poderá ver um subconjunto dessa lista. 
    >
    > - Se você não tiver um verificador de vulnerabilidades de terceiros configurado, não será oferecido a oportunidade de implantá-lo.
    > - Se as VMs selecionadas não estiverem protegidas com o Azure defender, a opção de scanner de vulnerabilidade integrada ASC estará indisponível.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="As opções para qual tipo de fluxo de correção você deseja escolher ao responder à recomendação * * uma solução de avaliação de vulnerabilidade deve ser habilitada na página de recomendação de suas máquinas virtuais * *":::

1. Se você estiver configurando uma nova configuração do BYOL, selecione **configurar um novo scanner de vulnerabilidade** de terceiros, selecione a extensão relevante, selecione **continuar** e insira os detalhes do provedor da seguinte maneira:

    1. Em **Grupo de recursos**, marque **Usar existente**.
    1. Em **Local**, escolha o local onde a solução ficará localizada geograficamente.
    1. Para Qualys, insira a licença fornecida pelo Qualys no campo **código de licença** .
    1. Para Rapid7, carregue o **arquivo de configuração Rapid7**.
    1. Na caixa **chave pública** , insira as informações de chave pública fornecidas pelo parceiro.
    1. Para instalar automaticamente esse agente de avaliação de vulnerabilidade em todas as VMs descobertas na assinatura dessa solução, selecione **implantação automática**.
    1. Selecione **OK**.

1. Se você já configurou sua solução BYOL, selecione **implantar seu verificador de vulnerabilidades** de terceiros configurado, selecione a extensão relevante e selecione **continuar**.

Depois que a solução de avaliação de vulnerabilidade estiver instalada nos computadores de destino, a central de segurança executará uma verificação para detectar e identificar vulnerabilidades no sistema e no aplicativo. Talvez demore algumas horas até a conclusão da primeira verificação. Depois disso, ele é executado por hora.



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>Implantar uma solução BYOL usando o PowerShell e a API REST

Para implantar de forma programática sua própria solução de avaliação de vulnerabilidade licenciada de forma privada do [Qualys](https://www.qualys.com/lp/azure) ou [Rapid7](https://www.rapid7.com/products/insightvm/), use o script fornecido do [PowerShell > solução de vulnerabilidade](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution). Esse script usa a API REST para criar uma nova solução de segurança em ASC. Você precisará de uma licença e uma chave fornecida pelo seu provedor de serviços (Qualys ou Rapid7).

> [!IMPORTANT] 
> Apenas uma solução pode ser criada por licença. A tentativa de criar outra solução usando o mesmo nome/licença/chave falhará.

### <a name="prerequisites"></a>Pré-requisitos

Módulos do PowerShell necessários:

- Instalar-módulo AZ
- Instalar-módulo AZ. Security

### <a name="run-the-script"></a>Executar o script

Para executar o script, você precisará das informações relevantes para os parâmetros abaixo.

| **Parâmetro** | **Necessária** | **Observações** |
|----|:----:|----|
|**SubscriptionId**|✔|A SubscriptionId da assinatura do Azure que contém os recursos que você deseja analisar.|
|**ResourceGroupName**|✔|Nome do grupo de recursos. Use qualquer grupo de recursos existente, incluindo o padrão ("defaultresource Group-xxx"). Como a solução não é um recurso do Azure, ela não será listada no grupo de recursos, mas ainda será anexada a ela.|
|**vaSolutionName**|✔|O nome da nova solução.|
|**vaType**|✔|Qualys ou Rapid7.|
|**licenceCode**|✔|Cadeia de licença fornecida pelo fornecedor.|
|**publicKey**|✔|Chave pública fornecida pelo fornecedor.|
|**autoUpdate**|-|Habilite (true) ou desabilite (false) implantar automaticamente para esta solução de VA. Quando habilitado, todas as novas VMs na assinatura tentarão automaticamente vincular à solução.<br/>(Padrão: false)|
||||

Sintaxe:

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

Exemplo (Este exemplo não inclui detalhes de licença válidos):

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="faq---byol-vulnerability-scanner"></a>Perguntas frequentes – verificador de vulnerabilidades BYOL

### <a name="if-i-deploy-a-qualys-agent-what-communications-settings-are-required"></a>Se eu implantar um agente do Qualys, quais configurações de comunicação são necessárias?

O agente de nuvem Qualys foi projetado para se comunicar com o SOC de Qualys em intervalos regulares para atualizações e para executar as várias operações necessárias para a funcionalidade do produto. Para permitir que o agente se comunique diretamente com o SOC, configure sua segurança de rede para permitir o tráfego de entrada e saída para o CIDR e URLs do Qualys SOC.

Há várias plataformas Qualys em vários locais geográficos. O CIDR e as URLs do SOC serão diferentes dependendo da plataforma de host da sua assinatura do Qualys. Para identificar sua plataforma de host Qualys, use esta página https://www.qualys.com/platform-identification/ .


## <a name="next-steps"></a>Próximas etapas

> [!div class="nextstepaction"]
> [Corrigir as conclusões de sua solução de avaliação de vulnerabilidade](remediate-vulnerability-findings-vm.md)


A Central de Segurança também oferece análise de vulnerabilidades para:

- Bancos de dados SQL - confira [Explorar relatórios de avaliação de vulnerabilidades no painel de avaliação de vulnerabilidades](defender-for-sql-usage.md#explore-vulnerability-assessment-reports)
- Imagens do registro de contêiner do Azure-consulte [usar o Azure defender para registros de contêiner para verificar se há vulnerabilidades em suas imagens](defender-for-container-registries-usage.md)